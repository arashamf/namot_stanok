ARM GAS  /tmp/ccAdRtMf.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"menu.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.section	.text.init_loop,"ax",%progbits
  18              		.align	1
  19              		.global	init_loop
  20              		.syntax unified
  21              		.thumb
  22              		.thumb_func
  24              	init_loop:
  25              	.LFB950:
  26              		.file 1 "display/menu.c"
   1:display/menu.c **** 
   2:display/menu.c **** // Includes ---------------------------------------------------------------------------------------
   3:display/menu.c **** #include "menu.h"
   4:display/menu.c **** #include "typedef.h"
   5:display/menu.c **** #include "tim.h"
   6:display/menu.c **** #include "button.h"
   7:display/menu.c **** #include "drive.h"
   8:display/menu.c **** #include "ssd1306.h"
   9:display/menu.c **** #include "fonts.h"
  10:display/menu.c **** #include "calc_value.h"
  11:display/menu.c **** #include "encoder.h"
  12:display/menu.c **** #include "usart.h"
  13:display/menu.c **** #include "gpio.h"
  14:display/menu.c **** #include "iwdg.h"
  15:display/menu.c **** 
  16:display/menu.c **** // Declarations and definitions -------------------------------------------------------------------
  17:display/menu.c **** 
  18:display/menu.c **** // Variables --------------------------------------------------------------------------------------
  19:display/menu.c **** uint8_t count_delay = 0; //–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∏—Ç–µ—Ä–∞—Ü–∏–π –ø–æ 10 –º—Å –¥–ª—è –∑–∞–¥–µ—Ä–∂–∫
  20:display/menu.c **** __IO uint8_t drive_mode = PRESET1; //–Ω–æ–º–µ—Ä –ø—Ä–µ—Å–µ—Ç–∞
  21:display/menu.c **** 
  22:display/menu.c **** // Functions --------------------------------------------------------------------------------------
  23:display/menu.c **** void init_loop (void)	
  24:display/menu.c **** {
  27              		.loc 1 24 1 view -0
  28              		.cfi_startproc
  29              		@ args = 0, pretend = 0, frame = 8
  30              		@ frame_needed = 0, uses_anonymous_args = 0
  31 0000 00B5     		push	{lr}
  32              	.LCFI0:
  33              		.cfi_def_cfa_offset 4
  34              		.cfi_offset 14, -4
ARM GAS  /tmp/ccAdRtMf.s 			page 2


  35 0002 83B0     		sub	sp, sp, #12
  36              	.LCFI1:
  37              		.cfi_def_cfa_offset 16
  25:display/menu.c **** 	__IO uint16_t key_code = NO_KEY; //–∫–æ–¥ –∫–Ω–æ–ø–∫–∏
  38              		.loc 1 25 2 view .LVU1
  39              		.loc 1 25 16 is_stmt 0 view .LVU2
  40 0004 0023     		movs	r3, #0
  41 0006 ADF80630 		strh	r3, [sp, #6]	@ movhi
  26:display/menu.c **** 	while (count_delay < START_DELAY) //–∑–∞–¥–µ—Ä–∂–∫–∞ 1—Å
  42              		.loc 1 26 2 is_stmt 1 view .LVU3
  43              		.loc 1 26 8 is_stmt 0 view .LVU4
  44 000a 0BE0     		b	.L2
  45              	.L3:
  27:display/menu.c **** 	{
  28:display/menu.c **** 		if ((key_code = start_scan_key_PEDAL()) == NO_KEY)  //–µ—Å–ª–∏ –ø–µ–¥–∞–ª—å –Ω–∞–∂–∞—Ç–∞
  29:display/menu.c **** 		{	count_delay++; }
  30:display/menu.c **** 		else
  31:display/menu.c **** 		{
  32:display/menu.c **** 			release_pedal_menu (); //–ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ –Ω–∞–∂–∞—Ç–∏–µ –ø–µ–¥–∞–ª–∏
  46              		.loc 1 32 4 is_stmt 1 view .LVU5
  47 000c FFF7FEFF 		bl	release_pedal_menu
  48              	.LVL0:
  33:display/menu.c **** 			while ((key_code = start_scan_key_PEDAL()) != NO_KEY) {}
  49              		.loc 1 33 4 view .LVU6
  50              	.L5:
  51              		.loc 1 33 59 discriminator 1 view .LVU7
  52              		.loc 1 33 10 discriminator 1 view .LVU8
  53              		.loc 1 33 23 is_stmt 0 discriminator 1 view .LVU9
  54 0010 FFF7FEFF 		bl	start_scan_key_PEDAL
  55              	.LVL1:
  56              		.loc 1 33 21 discriminator 1 view .LVU10
  57 0014 ADF80600 		strh	r0, [sp, #6]	@ movhi
  58              		.loc 1 33 10 discriminator 1 view .LVU11
  59 0018 0028     		cmp	r0, #0
  60 001a F9D1     		bne	.L5
  61              	.L4:
  34:display/menu.c **** 		}	
  35:display/menu.c **** 		delay_us (10000);
  62              		.loc 1 35 3 is_stmt 1 view .LVU12
  63 001c 42F21070 		movw	r0, #10000
  64 0020 FFF7FEFF 		bl	delay_us
  65              	.LVL2:
  66              	.L2:
  26:display/menu.c **** 	{
  67              		.loc 1 26 8 view .LVU13
  26:display/menu.c **** 	{
  68              		.loc 1 26 21 is_stmt 0 view .LVU14
  69 0024 094B     		ldr	r3, .L9
  70 0026 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  26:display/menu.c **** 	{
  71              		.loc 1 26 8 view .LVU15
  72 0028 632B     		cmp	r3, #99
  73 002a 0AD8     		bhi	.L8
  28:display/menu.c **** 		{	count_delay++; }
  74              		.loc 1 28 3 is_stmt 1 view .LVU16
  28:display/menu.c **** 		{	count_delay++; }
  75              		.loc 1 28 19 is_stmt 0 view .LVU17
ARM GAS  /tmp/ccAdRtMf.s 			page 3


  76 002c FFF7FEFF 		bl	start_scan_key_PEDAL
  77              	.LVL3:
  28:display/menu.c **** 		{	count_delay++; }
  78              		.loc 1 28 17 view .LVU18
  79 0030 ADF80600 		strh	r0, [sp, #6]	@ movhi
  28:display/menu.c **** 		{	count_delay++; }
  80              		.loc 1 28 6 view .LVU19
  81 0034 0028     		cmp	r0, #0
  82 0036 E9D1     		bne	.L3
  29:display/menu.c **** 		else
  83              		.loc 1 29 5 is_stmt 1 view .LVU20
  29:display/menu.c **** 		else
  84              		.loc 1 29 16 is_stmt 0 view .LVU21
  85 0038 044A     		ldr	r2, .L9
  86 003a 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
  87 003c 0133     		adds	r3, r3, #1
  88 003e 1370     		strb	r3, [r2]
  89 0040 ECE7     		b	.L4
  90              	.L8:
  36:display/menu.c **** 	}
  37:display/menu.c **** 	init_status_flags_drives();
  91              		.loc 1 37 2 is_stmt 1 view .LVU22
  92 0042 FFF7FEFF 		bl	init_status_flags_drives
  93              	.LVL4:
  38:display/menu.c **** }
  94              		.loc 1 38 1 is_stmt 0 view .LVU23
  95 0046 03B0     		add	sp, sp, #12
  96              	.LCFI2:
  97              		.cfi_def_cfa_offset 4
  98              		@ sp needed
  99 0048 5DF804FB 		ldr	pc, [sp], #4
 100              	.L10:
 101              		.align	2
 102              	.L9:
 103 004c 00000000 		.word	.LANCHOR0
 104              		.cfi_endproc
 105              	.LFE950:
 107              		.section	.text.setup_menu,"ax",%progbits
 108              		.align	1
 109              		.global	setup_menu
 110              		.syntax unified
 111              		.thumb
 112              		.thumb_func
 114              	setup_menu:
 115              	.LVL5:
 116              	.LFB952:
  39:display/menu.c **** 
  40:display/menu.c **** //-------------------------------------------------------------------------------------------------
  41:display/menu.c **** void main_loop (encoder_data_t * HandleEncData, coil_data_t ** HandleCoilData)
  42:display/menu.c **** {
  43:display/menu.c **** 	__IO uint16_t key_code = NO_KEY; //–∫–æ–¥ –∫–Ω–æ–ø–∫–∏
  44:display/menu.c **** 	if ((key_code = scan_keys()) != NO_KEY)
  45:display/menu.c **** 	{
  46:display/menu.c **** 		switch (key_code) //–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞ –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
  47:display/menu.c **** 		{	
  48:display/menu.c **** 			case KEY_PEDAL_LONG:
  49:display/menu.c **** 				start_drives_turn (drive_mode, *(HandleCoilData + (drive_mode-1))); //–≤—ã–ø–æ–Ω–µ–Ω–∏–µ –ø—Ä–µ
ARM GAS  /tmp/ccAdRtMf.s 			page 4


  50:display/menu.c **** 				while (scan_button_PEDAL() != OFF) {}	//–æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ–¥–∞–ª–∏
  51:display/menu.c **** 				break;
  52:display/menu.c **** 					
  53:display/menu.c **** 			case KEY_SETUP_SHORT:	
  54:display/menu.c **** 				drive_mode = menu_select_preset(HandleEncData, HandleCoilData);	//—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ 
  55:display/menu.c **** 				break;
  56:display/menu.c **** 			
  57:display/menu.c **** 			case KEY_SETUP_LONG:
  58:display/menu.c **** 				if (drive_mode != NO_PRESET) //–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–º–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–≥–
  59:display/menu.c **** 				{	settings_preset_reset (drive_mode, *(HandleCoilData + (drive_mode-1))); }//—Å–±—Ä–æ—Å –≤—ã–ø–
  60:display/menu.c **** 				break;
  61:display/menu.c **** 				
  62:display/menu.c **** 			case KEY_NULL_SHORT:
  63:display/menu.c **** 			case KEY_NULL_LONG:
  64:display/menu.c **** 				mode_setup_null_screen(); //–∑–∞—Å—Ç–∞–≤–∫–∞ —Ä–µ–∂–∏–º–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å–¥–≤–∏–≥–∞—é—â–µ
  65:display/menu.c **** 				setup_null_position ();  //—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–µ–ª—è –≤ –Ω—É–ª–µ
  66:display/menu.c **** 				if (drive_mode != NO_PRESET) //–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–º–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–≥–
  67:display/menu.c **** 				{	turn_drive_menu (drive_mode, *(HandleCoilData + (drive_mode-1)), 0); }//–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–
  68:display/menu.c **** 				else
  69:display/menu.c **** 				{	main_menu_select_preset_screen(); }	//–∑–∞—Å—Ç–∞–≤–∫–∞ –≥–ª–∞–≤–Ω–æ–≥–æ –º–µ–Ω—é
  70:display/menu.c **** 				break;
  71:display/menu.c **** 			
  72:display/menu.c **** 			case KEY_MANUAL_SHORT:
  73:display/menu.c **** 			case KEY_MANUAL_LONG:
  74:display/menu.c **** 				mode_setup_manual_dir_screen(); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ –≤—ã–±–æ—Ä–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏
  75:display/menu.c **** 				while (select_direction() == ERROR) {} //–æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—
  76:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
  77:display/menu.c **** 				manual_control_drive1 ();	//—Ñ-—è —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Å–¥–≤–∏–≥
  78:display/menu.c **** 				main_menu_select_preset_screen(); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–
  79:display/menu.c **** 				break;
  80:display/menu.c **** 		
  81:display/menu.c **** 			default:
  82:display/menu.c **** 				break;	
  83:display/menu.c **** 		}			
  84:display/menu.c **** 	}
  85:display/menu.c **** }
  86:display/menu.c **** 
  87:display/menu.c **** //-------------------------------------------------------------------------------------------------
  88:display/menu.c **** void setup_menu (encoder_data_t * HandleEncData, coil_data_t * HandleCoilData)
  89:display/menu.c **** {
 117              		.loc 1 89 1 is_stmt 1 view -0
 118              		.cfi_startproc
 119              		@ args = 0, pretend = 0, frame = 0
 120              		@ frame_needed = 0, uses_anonymous_args = 0
 121              		.loc 1 89 1 is_stmt 0 view .LVU25
 122 0000 F8B5     		push	{r3, r4, r5, r6, r7, lr}
 123              	.LCFI3:
 124              		.cfi_def_cfa_offset 24
 125              		.cfi_offset 3, -24
 126              		.cfi_offset 4, -20
 127              		.cfi_offset 5, -16
 128              		.cfi_offset 6, -12
 129              		.cfi_offset 7, -8
 130              		.cfi_offset 14, -4
 131 0002 0546     		mov	r5, r0
 132 0004 0C46     		mov	r4, r1
  90:display/menu.c **** 	uint16_t key_code = NO_KEY;	
ARM GAS  /tmp/ccAdRtMf.s 			page 5


 133              		.loc 1 90 2 is_stmt 1 view .LVU26
 134              	.LVL6:
  91:display/menu.c **** 	
  92:display/menu.c **** 	//–≤–≤–æ–¥ —Å–∫–æ—Ä–æ—Å—Ç–∏
  93:display/menu.c **** 	if(HandleCoilData->drive2_turn_in_minute == 0) 
 135              		.loc 1 93 2 view .LVU27
 136              		.loc 1 93 19 is_stmt 0 view .LVU28
 137 0006 8B88     		ldrh	r3, [r1, #4]	@ unaligned
 138              		.loc 1 93 4 view .LVU29
 139 0008 1BB9     		cbnz	r3, .L12
  94:display/menu.c **** 	{	HandleCoilData->drive2_turn_in_minute = BASE_TURN_IN_MINUTE; }
 140              		.loc 1 94 4 is_stmt 1 view .LVU30
 141              		.loc 1 94 42 is_stmt 0 view .LVU31
 142 000a 1E23     		movs	r3, #30
 143 000c 0B71     		strb	r3, [r1, #4]
 144 000e 0023     		movs	r3, #0
 145 0010 4B71     		strb	r3, [r1, #5]
 146              	.L12:
  95:display/menu.c **** 
  96:display/menu.c **** 	if(HandleCoilData->gear_ratio == 0) 
 147              		.loc 1 96 2 is_stmt 1 view .LVU32
 148              		.loc 1 96 19 is_stmt 0 view .LVU33
 149 0012 E388     		ldrh	r3, [r4, #6]	@ unaligned
 150              		.loc 1 96 4 view .LVU34
 151 0014 1BB9     		cbnz	r3, .L13
  97:display/menu.c **** 	{	HandleCoilData->gear_ratio = DEFAULT_GEAR_RATIO; }	
 152              		.loc 1 97 4 is_stmt 1 view .LVU35
 153              		.loc 1 97 31 is_stmt 0 view .LVU36
 154 0016 6423     		movs	r3, #100
 155 0018 A371     		strb	r3, [r4, #6]
 156 001a 0023     		movs	r3, #0
 157 001c E371     		strb	r3, [r4, #7]
 158              	.L13:
  98:display/menu.c **** 
  99:display/menu.c **** 	Stop_Count_Timers(); //–æ—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å—á—ë—Ç–Ω—ã—Ö —Ç–∞–π–º–µ—Ä–æ–≤
 159              		.loc 1 99 2 is_stmt 1 view .LVU37
 160 001e FFF7FEFF 		bl	Stop_Count_Timers
 161              	.LVL7:
 100:display/menu.c **** 	HandleCoilData->pulse_frequency = calc_rotation_speed(HandleCoilData->drive2_turn_in_minute); //—Ä
 162              		.loc 1 100 2 view .LVU38
 163              		.loc 1 100 36 is_stmt 0 view .LVU39
 164 0022 A088     		ldrh	r0, [r4, #4]	@ unaligned
 165 0024 FFF7FEFF 		bl	calc_rotation_speed
 166              	.LVL8:
 167              		.loc 1 100 34 view .LVU40
 168 0028 6080     		strh	r0, [r4, #2]	@ unaligned
 101:display/menu.c **** 	drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 169              		.loc 1 101 2 is_stmt 1 view .LVU41
 170 002a 2046     		mov	r0, r4
 171 002c FFF7FEFF 		bl	drive2_turn
 172              	.LVL9:
 102:display/menu.c **** 	drive1_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 173              		.loc 1 102 2 view .LVU42
 174 0030 2046     		mov	r0, r4
 175 0032 FFF7FEFF 		bl	drive1_turn
 176              	.LVL10:
 103:display/menu.c **** 
ARM GAS  /tmp/ccAdRtMf.s 			page 6


 104:display/menu.c **** 	setup_speed_screen (HandleCoilData->drive2_turn_in_minute);
 177              		.loc 1 104 2 view .LVU43
 178 0036 B4F90400 		ldrsh	r0, [r4, #4]	@ unaligned
 179 003a FFF7FEFF 		bl	setup_speed_screen
 180              	.LVL11:
 181              	.L17:
 105:display/menu.c **** 	while (1)
 182              		.loc 1 105 2 view .LVU44
 106:display/menu.c **** 	{
 107:display/menu.c **** 		if (read_encoder (HandleEncData) == ON) //–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç —ç–Ω–∫–æ–¥–µ—Ä–∞ –∏–∑–º–µ–Ω–
 183              		.loc 1 107 3 view .LVU45
 184              		.loc 1 107 7 is_stmt 0 view .LVU46
 185 003e 2846     		mov	r0, r5
 186 0040 FFF7FEFF 		bl	read_encoder
 187              	.LVL12:
 188              		.loc 1 107 6 view .LVU47
 189 0044 0128     		cmp	r0, #1
 190 0046 44D0     		beq	.L31
 191              	.L14:
 108:display/menu.c **** 		{
 109:display/menu.c **** 			HandleCoilData->drive2_turn_in_minute += 3*HandleEncData->delta; //–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–µ–ª—å
 110:display/menu.c **** 			HandleEncData->delta = 0; //–æ–±–Ω—É–ª–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã –ø–æ–∫–∞–∑–∞–Ω–∏–π —ç–Ω–∫–æ–¥–µ—Ä–∞
 111:display/menu.c **** 			if (HandleCoilData->drive2_turn_in_minute > MAX_VALUE_TURN) //–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 112:display/menu.c **** 			{	HandleCoilData->drive2_turn_in_minute = MIN_VALUE_TURN;	}
 113:display/menu.c **** 			else
 114:display/menu.c **** 			{
 115:display/menu.c **** 				if (HandleCoilData->drive2_turn_in_minute <	MIN_VALUE_TURN)
 116:display/menu.c **** 				{	HandleCoilData->drive2_turn_in_minute = MAX_VALUE_TURN;	}
 117:display/menu.c **** 			}
 118:display/menu.c **** 			HandleCoilData->pulse_frequency = calc_rotation_speed(HandleCoilData->drive2_turn_in_minute); //
 119:display/menu.c **** 			drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 120:display/menu.c **** 			drive1_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 121:display/menu.c **** 			setup_speed_screen (HandleCoilData->drive2_turn_in_minute);
 122:display/menu.c **** 		}	
 123:display/menu.c **** 		if ((key_code = scan_keys()) != NO_KEY) //–µ—Å–ª–∏ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞
 192              		.loc 1 123 3 is_stmt 1 view .LVU48
 193              		.loc 1 123 19 is_stmt 0 view .LVU49
 194 0048 FFF7FEFF 		bl	scan_keys
 195              	.LVL13:
 196              		.loc 1 123 6 view .LVU50
 197 004c 0028     		cmp	r0, #0
 198 004e F6D0     		beq	.L17
 124:display/menu.c **** 		{
 125:display/menu.c **** 			if (key_code ==  KEY_SETUP_SHORT) //–∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —ç–Ω–∫–æ–¥–µ—Ä–
 199              		.loc 1 125 4 is_stmt 1 view .LVU51
 200              		.loc 1 125 7 is_stmt 0 view .LVU52
 201 0050 0528     		cmp	r0, #5
 202 0052 F4D1     		bne	.L17
 126:display/menu.c **** 			{	break;	}
 127:display/menu.c **** 		}
 128:display/menu.c **** 	}	
 129:display/menu.c **** 	
 130:display/menu.c **** 	//—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–¥–∞—Ç–æ—á–Ω–æ–≥–æ —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏—è
 131:display/menu.c **** 	setup_ratio_screen (HandleCoilData->gear_ratio);
 203              		.loc 1 131 2 is_stmt 1 view .LVU53
 204 0054 B4F90600 		ldrsh	r0, [r4, #6]	@ unaligned
 205              	.LVL14:
ARM GAS  /tmp/ccAdRtMf.s 			page 7


 206              		.loc 1 131 2 is_stmt 0 view .LVU54
 207 0058 FFF7FEFF 		bl	setup_ratio_screen
 208              	.LVL15:
 209              	.L21:
 132:display/menu.c **** 	
 133:display/menu.c **** 	while (1)
 210              		.loc 1 133 2 is_stmt 1 view .LVU55
 134:display/menu.c **** 	{
 135:display/menu.c **** 		if (read_encoder (HandleEncData) == ON) //–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç —ç–Ω–∫–æ–¥–µ—Ä–∞ –∏–∑–º–µ–Ω–
 211              		.loc 1 135 3 view .LVU56
 212              		.loc 1 135 7 is_stmt 0 view .LVU57
 213 005c 2846     		mov	r0, r5
 214 005e FFF7FEFF 		bl	read_encoder
 215              	.LVL16:
 216              		.loc 1 135 6 view .LVU58
 217 0062 0128     		cmp	r0, #1
 218 0064 5ED0     		beq	.L32
 219              	.L18:
 136:display/menu.c **** 		{
 137:display/menu.c **** 			HandleCoilData->gear_ratio += 5*HandleEncData->delta;
 138:display/menu.c **** 			HandleEncData->delta = 0;
 139:display/menu.c **** 			if (HandleCoilData->gear_ratio > MAX_VALUE_RATIO)
 140:display/menu.c **** 			{	HandleCoilData->gear_ratio = MIN_VALUE_RATIO;	}
 141:display/menu.c **** 			else
 142:display/menu.c **** 			{
 143:display/menu.c **** 				if (HandleCoilData->gear_ratio < MIN_VALUE_RATIO)
 144:display/menu.c **** 				{	HandleCoilData->gear_ratio = MAX_VALUE_RATIO;	}
 145:display/menu.c **** 			}
 146:display/menu.c **** 			drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 147:display/menu.c **** 			drive1_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 148:display/menu.c **** 			setup_ratio_screen (HandleCoilData->gear_ratio);
 149:display/menu.c **** 		}	
 150:display/menu.c **** 		if ((key_code = scan_keys()) != NO_KEY) //–µ—Å–ª–∏ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞
 220              		.loc 1 150 3 is_stmt 1 view .LVU59
 221              		.loc 1 150 19 is_stmt 0 view .LVU60
 222 0066 FFF7FEFF 		bl	scan_keys
 223              	.LVL17:
 224              		.loc 1 150 6 view .LVU61
 225 006a 0028     		cmp	r0, #0
 226 006c F6D0     		beq	.L21
 151:display/menu.c **** 		{
 152:display/menu.c **** 			if (key_code == KEY_SETUP_SHORT) //–∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —ç–Ω–∫–æ–¥–µ—Ä–∞
 227              		.loc 1 152 4 is_stmt 1 view .LVU62
 228              		.loc 1 152 7 is_stmt 0 view .LVU63
 229 006e 0528     		cmp	r0, #5
 230 0070 F4D1     		bne	.L21
 153:display/menu.c **** 			{	
 154:display/menu.c **** 				SoftStop_Drives() ;
 231              		.loc 1 154 5 is_stmt 1 view .LVU64
 232 0072 FFF7FEFF 		bl	SoftStop_Drives
 233              	.LVL18:
 155:display/menu.c **** 				HardStop_Drives () ;
 234              		.loc 1 155 5 view .LVU65
 235 0076 FFF7FEFF 		bl	HardStop_Drives
 236              	.LVL19:
 156:display/menu.c **** 				status_drives.end_turn_drive1 = DRIVE_FREE;		
 237              		.loc 1 156 5 view .LVU66
ARM GAS  /tmp/ccAdRtMf.s 			page 8


 238              		.loc 1 156 35 is_stmt 0 view .LVU67
 239 007a 594B     		ldr	r3, .L36
 240 007c 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 241 007e 42F00202 		orr	r2, r2, #2
 242 0082 1A70     		strb	r2, [r3]
 157:display/menu.c **** 				status_drives.end_turn_drive2 = DRIVE_FREE;
 243              		.loc 1 157 5 is_stmt 1 view .LVU68
 244              		.loc 1 157 35 is_stmt 0 view .LVU69
 245 0084 1A78     		ldrb	r2, [r3]	@ zero_extendqisi2
 246 0086 42F00402 		orr	r2, r2, #4
 247 008a 1A70     		strb	r2, [r3]
 158:display/menu.c **** 				break;
 248              		.loc 1 158 5 is_stmt 1 view .LVU70
 159:display/menu.c **** 			}
 160:display/menu.c **** 		}
 161:display/menu.c **** 	}	
 162:display/menu.c **** 
 163:display/menu.c **** 	//—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤–∏—Ç–∫–æ–≤ –æ–±–º–æ—Ç–æ–∫
 164:display/menu.c **** 	for (uint8_t count = 0; count < MAX_NUMBER_COIL; count++)
 249              		.loc 1 164 2 view .LVU71
 250              	.LBB2:
 251              		.loc 1 164 7 view .LVU72
 252              	.LVL20:
 253              		.loc 1 164 15 is_stmt 0 view .LVU73
 254 008c 0023     		movs	r3, #0
 255              	.LVL21:
 256              	.L22:
 257              		.loc 1 164 26 is_stmt 1 discriminator 1 view .LVU74
 258              		.loc 1 164 2 is_stmt 0 discriminator 1 view .LVU75
 259 008e 022B     		cmp	r3, #2
 260 0090 00F2A080 		bhi	.L33
 165:display/menu.c **** 	{
 166:display/menu.c **** 		setup_coil_screen (count+1, HandleCoilData->set_coil[count]); //–∑–∞—Å—Ç–∞–≤–∫–∞ —Ä–µ–∂–∏–º–∞ —É—
 261              		.loc 1 166 3 is_stmt 1 view .LVU76
 262 0094 5F1C     		adds	r7, r3, #1
 263 0096 FFB2     		uxtb	r7, r7
 264              		.loc 1 166 55 is_stmt 0 view .LVU77
 265 0098 1E46     		mov	r6, r3
 266 009a 0433     		adds	r3, r3, #4
 267              	.LVL22:
 268              		.loc 1 166 3 view .LVU78
 269 009c 34F81310 		ldrh	r1, [r4, r3, lsl #1]	@ unaligned
 270 00a0 3846     		mov	r0, r7
 271 00a2 FFF7FEFF 		bl	setup_coil_screen
 272              	.LVL23:
 273              	.L26:
 167:display/menu.c **** 		while (1)
 274              		.loc 1 167 3 is_stmt 1 view .LVU79
 168:display/menu.c **** 		{
 169:display/menu.c **** 			if (read_encoder (HandleEncData) == ON) //–µ—Å–ª–∏ –¥–∞–Ω–Ω—ã–µ –æ—Ç —ç–Ω–∫–æ–¥–µ—Ä–∞ –∏–∑–º–µ–Ω
 275              		.loc 1 169 4 view .LVU80
 276              		.loc 1 169 8 is_stmt 0 view .LVU81
 277 00a6 2846     		mov	r0, r5
 278 00a8 FFF7FEFF 		bl	read_encoder
 279              	.LVL24:
 280              		.loc 1 169 7 view .LVU82
 281 00ac 0128     		cmp	r0, #1
ARM GAS  /tmp/ccAdRtMf.s 			page 9


 282 00ae 5ED0     		beq	.L34
 283              	.L23:
 170:display/menu.c **** 			{
 171:display/menu.c **** 				HandleCoilData->set_coil[count] += HandleEncData->delta; //–ø—Ä–∏–±–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–∏—Ä–∞—â–
 172:display/menu.c **** 				HandleEncData->delta = 0;				
 173:display/menu.c **** 				if (HandleCoilData->set_coil[count] < MIN_VALUE_COIL)
 174:display/menu.c **** 				{	HandleCoilData->set_coil[count] = MAX_VALUE_COIL;	}
 175:display/menu.c **** 				else
 176:display/menu.c **** 				{
 177:display/menu.c **** 					if (HandleCoilData->set_coil[count] > MAX_VALUE_COIL)
 178:display/menu.c **** 					{	HandleCoilData->set_coil[count] = MIN_VALUE_COIL;	}
 179:display/menu.c **** 				}
 180:display/menu.c **** 				setup_coil_screen (count+1, HandleCoilData->set_coil[count]); //–∑–∞—Å—Ç–∞–≤–∫–∞ —Ä–µ–∂–∏–º–∞ —
 181:display/menu.c **** 			}
 182:display/menu.c **** 			if ((key_code = scan_keys()) != NO_KEY) //–µ—Å–ª–∏ –±—ã–ª–∞ –Ω–∞–∂–∞—Ç–∞ –∫–Ω–æ–ø–∫–∞
 284              		.loc 1 182 4 is_stmt 1 view .LVU83
 285              		.loc 1 182 20 is_stmt 0 view .LVU84
 286 00b0 FFF7FEFF 		bl	scan_keys
 287              	.LVL25:
 288              		.loc 1 182 7 view .LVU85
 289 00b4 0028     		cmp	r0, #0
 290 00b6 F6D0     		beq	.L26
 183:display/menu.c **** 			{
 184:display/menu.c **** 				if (key_code == KEY_SETUP_LONG) //–¥–ª–∏–Ω–Ω–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —ç–Ω–∫–æ–¥–µ—Ä–∞ -
 291              		.loc 1 184 5 is_stmt 1 view .LVU86
 292              		.loc 1 184 8 is_stmt 0 view .LVU87
 293 00b8 0628     		cmp	r0, #6
 294 00ba 00F08180 		beq	.L35
 185:display/menu.c **** 				{		
 186:display/menu.c **** 					HandleCoilData->remains_coil[count] = HandleCoilData->set_coil[count]; //—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ
 187:display/menu.c **** 					HandleCoilData->set_numb_winding = count+1; //–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 188:display/menu.c **** 					HandleCoilData->complet_winding = 0; //–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–
 189:display/menu.c **** 					return;
 190:display/menu.c **** 				}	
 191:display/menu.c **** 				else
 192:display/menu.c **** 				{
 193:display/menu.c **** 					if (key_code == KEY_SETUP_SHORT) //–∫–æ—Ä–æ—Ç–∫–æ–µ –Ω–∞–∂–∞—Ç–∏–µ –∫–Ω–æ–ø–∫–∏ —ç–Ω–∫–æ–¥–µ—Ä
 295              		.loc 1 193 6 is_stmt 1 view .LVU88
 296              		.loc 1 193 9 is_stmt 0 view .LVU89
 297 00be 0528     		cmp	r0, #5
 298 00c0 F1D1     		bne	.L26
 194:display/menu.c **** 					{
 195:display/menu.c **** 						HandleCoilData->remains_coil[count] = HandleCoilData->set_coil[count]; //—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –
 299              		.loc 1 195 7 is_stmt 1 view .LVU90
 300              		.loc 1 195 69 is_stmt 0 view .LVU91
 301 00c2 0436     		adds	r6, r6, #4
 302 00c4 34F81630 		ldrh	r3, [r4, r6, lsl #1]	@ unaligned
 303              		.loc 1 195 43 view .LVU92
 304 00c8 04EB4606 		add	r6, r4, r6, lsl #1
 305 00cc F380     		strh	r3, [r6, #6]	@ unaligned
 196:display/menu.c **** 						break;
 306              		.loc 1 196 7 is_stmt 1 view .LVU93
 164:display/menu.c **** 	{
 307              		.loc 1 164 51 view .LVU94
 308              	.LVL26:
 164:display/menu.c **** 	{
 309              		.loc 1 164 56 is_stmt 0 view .LVU95
ARM GAS  /tmp/ccAdRtMf.s 			page 10


 310 00ce 3B46     		mov	r3, r7
 311 00d0 DDE7     		b	.L22
 312              	.LVL27:
 313              	.L31:
 164:display/menu.c **** 	{
 314              		.loc 1 164 56 view .LVU96
 315              	.LBE2:
 109:display/menu.c **** 			HandleEncData->delta = 0; //–æ–±–Ω—É–ª–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã –ø–æ–∫–∞–∑–∞–Ω–∏–π —ç–Ω–∫–æ–¥–µ—Ä–∞
 316              		.loc 1 109 4 is_stmt 1 view .LVU97
 109:display/menu.c **** 			HandleEncData->delta = 0; //–æ–±–Ω—É–ª–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã –ø–æ–∫–∞–∑–∞–Ω–∏–π —ç–Ω–∫–æ–¥–µ—Ä–∞
 317              		.loc 1 109 60 is_stmt 0 view .LVU98
 318 00d2 95F90430 		ldrsb	r3, [r5, #4]
 319 00d6 9BB2     		uxth	r3, r3
 109:display/menu.c **** 			HandleEncData->delta = 0; //–æ–±–Ω—É–ª–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã –ø–æ–∫–∞–∑–∞–Ω–∏–π —ç–Ω–∫–æ–¥–µ—Ä–∞
 320              		.loc 1 109 46 view .LVU99
 321 00d8 03EB4303 		add	r3, r3, r3, lsl #1
 322 00dc 9BB2     		uxth	r3, r3
 109:display/menu.c **** 			HandleEncData->delta = 0; //–æ–±–Ω—É–ª–µ–Ω–∏–µ –¥–µ–ª—å—Ç—ã –ø–æ–∫–∞–∑–∞–Ω–∏–π —ç–Ω–∫–æ–¥–µ—Ä–∞
 323              		.loc 1 109 42 view .LVU100
 324 00de A288     		ldrh	r2, [r4, #4]	@ unaligned
 325 00e0 1344     		add	r3, r3, r2
 326 00e2 A380     		strh	r3, [r4, #4]	@ unaligned
 110:display/menu.c **** 			if (HandleCoilData->drive2_turn_in_minute > MAX_VALUE_TURN) //–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 327              		.loc 1 110 4 is_stmt 1 view .LVU101
 110:display/menu.c **** 			if (HandleCoilData->drive2_turn_in_minute > MAX_VALUE_TURN) //–µ—Å–ª–∏ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 328              		.loc 1 110 25 is_stmt 0 view .LVU102
 329 00e4 0023     		movs	r3, #0
 330 00e6 2B71     		strb	r3, [r5, #4]
 111:display/menu.c **** 			{	HandleCoilData->drive2_turn_in_minute = MIN_VALUE_TURN;	}
 331              		.loc 1 111 4 is_stmt 1 view .LVU103
 111:display/menu.c **** 			{	HandleCoilData->drive2_turn_in_minute = MIN_VALUE_TURN;	}
 332              		.loc 1 111 22 is_stmt 0 view .LVU104
 333 00e8 A388     		ldrh	r3, [r4, #4]	@ unaligned
 111:display/menu.c **** 			{	HandleCoilData->drive2_turn_in_minute = MIN_VALUE_TURN;	}
 334              		.loc 1 111 7 view .LVU105
 335 00ea 962B     		cmp	r3, #150
 336 00ec 12D9     		bls	.L15
 112:display/menu.c **** 			else
 337              		.loc 1 112 6 is_stmt 1 view .LVU106
 112:display/menu.c **** 			else
 338              		.loc 1 112 44 is_stmt 0 view .LVU107
 339 00ee 0C23     		movs	r3, #12
 340 00f0 2371     		strb	r3, [r4, #4]
 341 00f2 0023     		movs	r3, #0
 342 00f4 6371     		strb	r3, [r4, #5]
 343              	.L16:
 118:display/menu.c **** 			drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 344              		.loc 1 118 4 is_stmt 1 view .LVU108
 118:display/menu.c **** 			drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 345              		.loc 1 118 38 is_stmt 0 view .LVU109
 346 00f6 A088     		ldrh	r0, [r4, #4]	@ unaligned
 347 00f8 FFF7FEFF 		bl	calc_rotation_speed
 348              	.LVL28:
 118:display/menu.c **** 			drive2_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ –≤—Ä–∞—â–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 349              		.loc 1 118 36 view .LVU110
 350 00fc 6080     		strh	r0, [r4, #2]	@ unaligned
 119:display/menu.c **** 			drive1_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
ARM GAS  /tmp/ccAdRtMf.s 			page 11


 351              		.loc 1 119 4 is_stmt 1 view .LVU111
 352 00fe 2046     		mov	r0, r4
 353 0100 FFF7FEFF 		bl	drive2_turn
 354              	.LVL29:
 120:display/menu.c **** 			setup_speed_screen (HandleCoilData->drive2_turn_in_minute);
 355              		.loc 1 120 4 view .LVU112
 356 0104 2046     		mov	r0, r4
 357 0106 FFF7FEFF 		bl	drive1_turn
 358              	.LVL30:
 121:display/menu.c **** 		}	
 359              		.loc 1 121 4 view .LVU113
 360 010a B4F90400 		ldrsh	r0, [r4, #4]	@ unaligned
 361 010e FFF7FEFF 		bl	setup_speed_screen
 362              	.LVL31:
 363 0112 99E7     		b	.L14
 364              	.L15:
 115:display/menu.c **** 				{	HandleCoilData->drive2_turn_in_minute = MAX_VALUE_TURN;	}
 365              		.loc 1 115 5 view .LVU114
 115:display/menu.c **** 				{	HandleCoilData->drive2_turn_in_minute = MAX_VALUE_TURN;	}
 366              		.loc 1 115 8 is_stmt 0 view .LVU115
 367 0114 0B2B     		cmp	r3, #11
 368 0116 EED8     		bhi	.L16
 116:display/menu.c **** 			}
 369              		.loc 1 116 7 is_stmt 1 view .LVU116
 116:display/menu.c **** 			}
 370              		.loc 1 116 45 is_stmt 0 view .LVU117
 371 0118 6FF06903 		mvn	r3, #105
 372 011c 2371     		strb	r3, [r4, #4]
 373 011e 0023     		movs	r3, #0
 374 0120 6371     		strb	r3, [r4, #5]
 375 0122 E8E7     		b	.L16
 376              	.L32:
 137:display/menu.c **** 			HandleEncData->delta = 0;
 377              		.loc 1 137 4 is_stmt 1 view .LVU118
 137:display/menu.c **** 			HandleEncData->delta = 0;
 378              		.loc 1 137 49 is_stmt 0 view .LVU119
 379 0124 95F90430 		ldrsb	r3, [r5, #4]
 380 0128 9BB2     		uxth	r3, r3
 137:display/menu.c **** 			HandleEncData->delta = 0;
 381              		.loc 1 137 35 view .LVU120
 382 012a 03EB8303 		add	r3, r3, r3, lsl #2
 383 012e 9BB2     		uxth	r3, r3
 137:display/menu.c **** 			HandleEncData->delta = 0;
 384              		.loc 1 137 31 view .LVU121
 385 0130 E288     		ldrh	r2, [r4, #6]	@ unaligned
 386 0132 1344     		add	r3, r3, r2
 387 0134 E380     		strh	r3, [r4, #6]	@ unaligned
 138:display/menu.c **** 			if (HandleCoilData->gear_ratio > MAX_VALUE_RATIO)
 388              		.loc 1 138 4 is_stmt 1 view .LVU122
 138:display/menu.c **** 			if (HandleCoilData->gear_ratio > MAX_VALUE_RATIO)
 389              		.loc 1 138 25 is_stmt 0 view .LVU123
 390 0136 0023     		movs	r3, #0
 391 0138 2B71     		strb	r3, [r5, #4]
 139:display/menu.c **** 			{	HandleCoilData->gear_ratio = MIN_VALUE_RATIO;	}
 392              		.loc 1 139 4 is_stmt 1 view .LVU124
 139:display/menu.c **** 			{	HandleCoilData->gear_ratio = MIN_VALUE_RATIO;	}
 393              		.loc 1 139 22 is_stmt 0 view .LVU125
ARM GAS  /tmp/ccAdRtMf.s 			page 12


 394 013a E388     		ldrh	r3, [r4, #6]	@ unaligned
 139:display/menu.c **** 			{	HandleCoilData->gear_ratio = MIN_VALUE_RATIO;	}
 395              		.loc 1 139 7 view .LVU126
 396 013c B3F5967F 		cmp	r3, #300
 397 0140 0ED9     		bls	.L19
 140:display/menu.c **** 			else
 398              		.loc 1 140 6 is_stmt 1 view .LVU127
 140:display/menu.c **** 			else
 399              		.loc 1 140 33 is_stmt 0 view .LVU128
 400 0142 1923     		movs	r3, #25
 401 0144 A371     		strb	r3, [r4, #6]
 402 0146 0023     		movs	r3, #0
 403 0148 E371     		strb	r3, [r4, #7]
 404              	.L20:
 146:display/menu.c **** 			drive1_turn (HandleCoilData);	//–∑–∞–ø—É—Å–∫ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–∞—Ç–µ–ª—è
 405              		.loc 1 146 4 is_stmt 1 view .LVU129
 406 014a 2046     		mov	r0, r4
 407 014c FFF7FEFF 		bl	drive2_turn
 408              	.LVL32:
 147:display/menu.c **** 			setup_ratio_screen (HandleCoilData->gear_ratio);
 409              		.loc 1 147 4 view .LVU130
 410 0150 2046     		mov	r0, r4
 411 0152 FFF7FEFF 		bl	drive1_turn
 412              	.LVL33:
 148:display/menu.c **** 		}	
 413              		.loc 1 148 4 view .LVU131
 414 0156 B4F90600 		ldrsh	r0, [r4, #6]	@ unaligned
 415 015a FFF7FEFF 		bl	setup_ratio_screen
 416              	.LVL34:
 417 015e 82E7     		b	.L18
 418              	.L19:
 143:display/menu.c **** 				{	HandleCoilData->gear_ratio = MAX_VALUE_RATIO;	}
 419              		.loc 1 143 5 view .LVU132
 143:display/menu.c **** 				{	HandleCoilData->gear_ratio = MAX_VALUE_RATIO;	}
 420              		.loc 1 143 8 is_stmt 0 view .LVU133
 421 0160 182B     		cmp	r3, #24
 422 0162 F2D8     		bhi	.L20
 144:display/menu.c **** 			}
 423              		.loc 1 144 7 is_stmt 1 view .LVU134
 144:display/menu.c **** 			}
 424              		.loc 1 144 34 is_stmt 0 view .LVU135
 425 0164 2C23     		movs	r3, #44
 426 0166 A371     		strb	r3, [r4, #6]
 427 0168 0123     		movs	r3, #1
 428 016a E371     		strb	r3, [r4, #7]
 429 016c EDE7     		b	.L20
 430              	.L34:
 431              	.LBB3:
 171:display/menu.c **** 				HandleEncData->delta = 0;				
 432              		.loc 1 171 5 is_stmt 1 view .LVU136
 171:display/menu.c **** 				HandleEncData->delta = 0;				
 433              		.loc 1 171 53 is_stmt 0 view .LVU137
 434 016e 95F90430 		ldrsb	r3, [r5, #4]
 435 0172 9BB2     		uxth	r3, r3
 171:display/menu.c **** 				HandleEncData->delta = 0;				
 436              		.loc 1 171 37 view .LVU138
 437 0174 321D     		adds	r2, r6, #4
ARM GAS  /tmp/ccAdRtMf.s 			page 13


 438 0176 34F81210 		ldrh	r1, [r4, r2, lsl #1]	@ unaligned
 439 017a 0B44     		add	r3, r3, r1
 440 017c 24F81230 		strh	r3, [r4, r2, lsl #1]	@ unaligned
 172:display/menu.c **** 				if (HandleCoilData->set_coil[count] < MIN_VALUE_COIL)
 441              		.loc 1 172 5 is_stmt 1 view .LVU139
 172:display/menu.c **** 				if (HandleCoilData->set_coil[count] < MIN_VALUE_COIL)
 442              		.loc 1 172 26 is_stmt 0 view .LVU140
 443 0180 0023     		movs	r3, #0
 444 0182 2B71     		strb	r3, [r5, #4]
 173:display/menu.c **** 				{	HandleCoilData->set_coil[count] = MAX_VALUE_COIL;	}
 445              		.loc 1 173 5 is_stmt 1 view .LVU141
 173:display/menu.c **** 				{	HandleCoilData->set_coil[count] = MAX_VALUE_COIL;	}
 446              		.loc 1 173 33 is_stmt 0 view .LVU142
 447 0184 34F81230 		ldrh	r3, [r4, r2, lsl #1]	@ unaligned
 173:display/menu.c **** 				{	HandleCoilData->set_coil[count] = MAX_VALUE_COIL;	}
 448              		.loc 1 173 8 view .LVU143
 449 0188 7BB9     		cbnz	r3, .L24
 174:display/menu.c **** 				else
 450              		.loc 1 174 7 is_stmt 1 view .LVU144
 174:display/menu.c **** 				else
 451              		.loc 1 174 39 is_stmt 0 view .LVU145
 452 018a 1346     		mov	r3, r2
 453 018c 6FF00502 		mvn	r2, #5
 454 0190 04F81320 		strb	r2, [r4, r3, lsl #1]
 455 0194 04EB4303 		add	r3, r4, r3, lsl #1
 456 0198 0022     		movs	r2, #0
 457 019a 5A70     		strb	r2, [r3, #1]
 458              	.L25:
 180:display/menu.c **** 			}
 459              		.loc 1 180 5 is_stmt 1 view .LVU146
 180:display/menu.c **** 			}
 460              		.loc 1 180 57 is_stmt 0 view .LVU147
 461 019c 331D     		adds	r3, r6, #4
 180:display/menu.c **** 			}
 462              		.loc 1 180 5 view .LVU148
 463 019e 34F81310 		ldrh	r1, [r4, r3, lsl #1]	@ unaligned
 464 01a2 3846     		mov	r0, r7
 465 01a4 FFF7FEFF 		bl	setup_coil_screen
 466              	.LVL35:
 467 01a8 82E7     		b	.L23
 468              	.L24:
 177:display/menu.c **** 					{	HandleCoilData->set_coil[count] = MIN_VALUE_COIL;	}
 469              		.loc 1 177 6 is_stmt 1 view .LVU149
 177:display/menu.c **** 					{	HandleCoilData->set_coil[count] = MIN_VALUE_COIL;	}
 470              		.loc 1 177 9 is_stmt 0 view .LVU150
 471 01aa FA2B     		cmp	r3, #250
 472 01ac F6D9     		bls	.L25
 178:display/menu.c **** 				}
 473              		.loc 1 178 8 is_stmt 1 view .LVU151
 178:display/menu.c **** 				}
 474              		.loc 1 178 40 is_stmt 0 view .LVU152
 475 01ae 331D     		adds	r3, r6, #4
 476 01b0 0122     		movs	r2, #1
 477 01b2 04F81320 		strb	r2, [r4, r3, lsl #1]
 478 01b6 04EB4303 		add	r3, r4, r3, lsl #1
 479 01ba 0022     		movs	r2, #0
 480 01bc 5A70     		strb	r2, [r3, #1]
ARM GAS  /tmp/ccAdRtMf.s 			page 14


 481 01be EDE7     		b	.L25
 482              	.LVL36:
 483              	.L35:
 186:display/menu.c **** 					HandleCoilData->set_numb_winding = count+1; //–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 484              		.loc 1 186 6 is_stmt 1 view .LVU153
 186:display/menu.c **** 					HandleCoilData->set_numb_winding = count+1; //–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 485              		.loc 1 186 68 is_stmt 0 view .LVU154
 486 01c0 0436     		adds	r6, r6, #4
 487 01c2 34F81630 		ldrh	r3, [r4, r6, lsl #1]	@ unaligned
 186:display/menu.c **** 					HandleCoilData->set_numb_winding = count+1; //–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±
 488              		.loc 1 186 42 view .LVU155
 489 01c6 04EB4606 		add	r6, r4, r6, lsl #1
 490 01ca F380     		strh	r3, [r6, #6]	@ unaligned
 187:display/menu.c **** 					HandleCoilData->complet_winding = 0; //–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–
 491              		.loc 1 187 6 is_stmt 1 view .LVU156
 187:display/menu.c **** 					HandleCoilData->complet_winding = 0; //–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–
 492              		.loc 1 187 39 is_stmt 0 view .LVU157
 493 01cc 2770     		strb	r7, [r4]
 188:display/menu.c **** 					return;
 494              		.loc 1 188 6 is_stmt 1 view .LVU158
 188:display/menu.c **** 					return;
 495              		.loc 1 188 38 is_stmt 0 view .LVU159
 496 01ce 0023     		movs	r3, #0
 497 01d0 6370     		strb	r3, [r4, #1]
 189:display/menu.c **** 				}	
 498              		.loc 1 189 6 is_stmt 1 view .LVU160
 499              	.LVL37:
 500              	.L11:
 189:display/menu.c **** 				}	
 501              		.loc 1 189 6 is_stmt 0 view .LVU161
 502              	.LBE3:
 197:display/menu.c **** 					}
 198:display/menu.c **** 				}
 199:display/menu.c **** 			}			
 200:display/menu.c **** 		}
 201:display/menu.c **** 	}
 202:display/menu.c **** 	HandleCoilData->set_numb_winding = MAX_NUMBER_COIL; //–Ω–µ–æ–±—Ö–æ–¥–∏–º–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ 
 203:display/menu.c **** 	HandleCoilData->complet_winding = 0;	//–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–Ω—ã—
 204:display/menu.c **** 	return;
 205:display/menu.c **** }
 503              		.loc 1 205 1 view .LVU162
 504 01d2 F8BD     		pop	{r3, r4, r5, r6, r7, pc}
 505              	.LVL38:
 506              	.L33:
 202:display/menu.c **** 	HandleCoilData->complet_winding = 0;	//–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–Ω—ã—
 507              		.loc 1 202 2 is_stmt 1 view .LVU163
 202:display/menu.c **** 	HandleCoilData->complet_winding = 0;	//–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–Ω—ã—
 508              		.loc 1 202 35 is_stmt 0 view .LVU164
 509 01d4 0323     		movs	r3, #3
 510              	.LVL39:
 202:display/menu.c **** 	HandleCoilData->complet_winding = 0;	//–∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞–º–æ—Ç–∞–Ω–Ω—ã—
 511              		.loc 1 202 35 view .LVU165
 512 01d6 2370     		strb	r3, [r4]
 203:display/menu.c **** 	return;
 513              		.loc 1 203 2 is_stmt 1 view .LVU166
 203:display/menu.c **** 	return;
 514              		.loc 1 203 34 is_stmt 0 view .LVU167
ARM GAS  /tmp/ccAdRtMf.s 			page 15


 515 01d8 0023     		movs	r3, #0
 516 01da 6370     		strb	r3, [r4, #1]
 204:display/menu.c **** }
 517              		.loc 1 204 2 is_stmt 1 view .LVU168
 518 01dc F9E7     		b	.L11
 519              	.L37:
 520 01de 00BF     		.align	2
 521              	.L36:
 522 01e0 00000000 		.word	status_drives
 523              		.cfi_endproc
 524              	.LFE952:
 526              		.section	.text.turn_drive_menu,"ax",%progbits
 527              		.align	1
 528              		.global	turn_drive_menu
 529              		.syntax unified
 530              		.thumb
 531              		.thumb_func
 533              	turn_drive_menu:
 534              	.LVL40:
 535              	.LFB954:
 206:display/menu.c **** 
 207:display/menu.c **** //-------------------------------------------------------------------------------------------------
 208:display/menu.c **** uint8_t menu_select_preset (encoder_data_t * HandleEncData, coil_data_t ** HandleBufCoilData)
 209:display/menu.c **** {
 210:display/menu.c **** 	__IO uint16_t key_code = NO_KEY;
 211:display/menu.c **** 	
 212:display/menu.c **** 	menu_select_preset_screen (drive_mode);
 213:display/menu.c **** 	while (1)
 214:display/menu.c **** 	{		
 215:display/menu.c **** 		if (read_encoder (HandleEncData) == ON) //—á—Ç–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —ç–Ω–∫–æ–¥–µ—Ä–∞
 216:display/menu.c **** 		{
 217:display/menu.c **** 			drive_mode += HandleEncData->delta; //–∏–∑–º–µ–Ω–µ–Ω–∏–µ —É–∫–∞–∑–∞—Ç–µ–ª—è –Ω–∞ –Ω–æ–º–µ—Ä –ø—Ä
 218:display/menu.c **** 			HandleEncData->delta = 0;	
 219:display/menu.c **** 			if (drive_mode > PRESET4)
 220:display/menu.c **** 			{	drive_mode = PRESET1;	}
 221:display/menu.c **** 			else
 222:display/menu.c **** 			{	
 223:display/menu.c **** 				if (drive_mode < PRESET1) 
 224:display/menu.c **** 				{	drive_mode = PRESET4;	}
 225:display/menu.c **** 			}	
 226:display/menu.c **** 			menu_select_preset_screen (drive_mode);				
 227:display/menu.c **** 		}		
 228:display/menu.c **** 			
 229:display/menu.c **** 		if ((key_code = scan_keys()) != NO_KEY)
 230:display/menu.c **** 		{
 231:display/menu.c **** 			switch (key_code) //–æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–¥–∞ –Ω–∞–∂–∞—Ç–æ–π –∫–Ω–æ–ø–∫–∏
 232:display/menu.c **** 			{	
 233:display/menu.c **** 				case KEY_SETUP_SHORT:
 234:display/menu.c **** 					setup_menu (HandleEncData, *(HandleBufCoilData+drive_mode-1)); //–ø–µ—Ä–µ—Ö–æ–¥ –≤ –º–µ–Ω—é –Ω
 235:display/menu.c **** 					break;
 236:display/menu.c **** 				
 237:display/menu.c **** 				case KEY_SETUP_LONG:
 238:display/menu.c **** 					turn_drive_menu (drive_mode, HandleBufCoilData[drive_mode-1], 0); //–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –Ω–
 239:display/menu.c **** 					return drive_mode; //–≤—ã—Ö–æ–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
 240:display/menu.c **** 					break;
 241:display/menu.c **** 			}
 242:display/menu.c **** 			menu_select_preset_screen (drive_mode);		
ARM GAS  /tmp/ccAdRtMf.s 			page 16


 243:display/menu.c **** 		}
 244:display/menu.c **** 	}
 245:display/menu.c **** }
 246:display/menu.c **** 
 247:display/menu.c **** 
 248:display/menu.c **** //-------------------------------------------------------------------------------------------------
 249:display/menu.c **** void turn_drive_menu (uint8_t numb_preset, coil_data_t * HandleCoilData, uint8_t numb_coil)
 250:display/menu.c **** {
 536              		.loc 1 250 1 view -0
 537              		.cfi_startproc
 538              		@ args = 0, pretend = 0, frame = 0
 539              		@ frame_needed = 0, uses_anonymous_args = 0
 540              		.loc 1 250 1 is_stmt 0 view .LVU170
 541 0000 08B5     		push	{r3, lr}
 542              	.LCFI4:
 543              		.cfi_def_cfa_offset 8
 544              		.cfi_offset 3, -8
 545              		.cfi_offset 14, -4
 251:display/menu.c **** 	default_screen (numb_preset, HandleCoilData->remains_coil[numb_coil], HandleCoilData->set_coil[num
 546              		.loc 1 251 2 is_stmt 1 view .LVU171
 547              		.loc 1 251 59 is_stmt 0 view .LVU172
 548 0002 02F1040C 		add	ip, r2, #4
 549 0006 01EB4C0E 		add	lr, r1, ip, lsl #1
 550              		.loc 1 251 2 view .LVU173
 551 000a 0132     		adds	r2, r2, #1
 552              	.LVL41:
 553              		.loc 1 251 2 view .LVU174
 554 000c D3B2     		uxtb	r3, r2
 555 000e 31F91C20 		ldrsh	r2, [r1, ip, lsl #1]	@ unaligned
 556 0012 BEF90610 		ldrsh	r1, [lr, #6]	@ unaligned
 557              	.LVL42:
 558              		.loc 1 251 2 view .LVU175
 559 0016 FFF7FEFF 		bl	default_screen
 560              	.LVL43:
 252:display/menu.c **** }
 561              		.loc 1 252 1 view .LVU176
 562 001a 08BD     		pop	{r3, pc}
 563              		.cfi_endproc
 564              	.LFE954:
 566              		.section	.text.menu_select_preset,"ax",%progbits
 567              		.align	1
 568              		.global	menu_select_preset
 569              		.syntax unified
 570              		.thumb
 571              		.thumb_func
 573              	menu_select_preset:
 574              	.LVL44:
 575              	.LFB953:
 209:display/menu.c **** 	__IO uint16_t key_code = NO_KEY;
 576              		.loc 1 209 1 is_stmt 1 view -0
 577              		.cfi_startproc
 578              		@ args = 0, pretend = 0, frame = 8
 579              		@ frame_needed = 0, uses_anonymous_args = 0
 209:display/menu.c **** 	__IO uint16_t key_code = NO_KEY;
 580              		.loc 1 209 1 is_stmt 0 view .LVU178
 581 0000 30B5     		push	{r4, r5, lr}
 582              	.LCFI5:
ARM GAS  /tmp/ccAdRtMf.s 			page 17


 583              		.cfi_def_cfa_offset 12
 584              		.cfi_offset 4, -12
 585              		.cfi_offset 5, -8
 586              		.cfi_offset 14, -4
 587 0002 83B0     		sub	sp, sp, #12
 588              	.LCFI6:
 589              		.cfi_def_cfa_offset 24
 590 0004 0446     		mov	r4, r0
 591 0006 0D46     		mov	r5, r1
 210:display/menu.c **** 	
 592              		.loc 1 210 2 is_stmt 1 view .LVU179
 210:display/menu.c **** 	
 593              		.loc 1 210 16 is_stmt 0 view .LVU180
 594 0008 0023     		movs	r3, #0
 595 000a ADF80630 		strh	r3, [sp, #6]	@ movhi
 212:display/menu.c **** 	while (1)
 596              		.loc 1 212 2 is_stmt 1 view .LVU181
 597 000e 274B     		ldr	r3, .L52
 598 0010 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 599              	.LVL45:
 212:display/menu.c **** 	while (1)
 600              		.loc 1 212 2 is_stmt 0 view .LVU182
 601 0012 FFF7FEFF 		bl	menu_select_preset_screen
 602              	.LVL46:
 212:display/menu.c **** 	while (1)
 603              		.loc 1 212 2 view .LVU183
 604 0016 0EE0     		b	.L44
 605              	.L42:
 223:display/menu.c **** 				{	drive_mode = PRESET4;	}
 606              		.loc 1 223 5 is_stmt 1 view .LVU184
 223:display/menu.c **** 				{	drive_mode = PRESET4;	}
 607              		.loc 1 223 20 is_stmt 0 view .LVU185
 608 0018 244B     		ldr	r3, .L52
 609 001a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 223:display/menu.c **** 				{	drive_mode = PRESET4;	}
 610              		.loc 1 223 8 view .LVU186
 611 001c 13B9     		cbnz	r3, .L43
 224:display/menu.c **** 			}	
 612              		.loc 1 224 7 is_stmt 1 view .LVU187
 224:display/menu.c **** 			}	
 613              		.loc 1 224 18 is_stmt 0 view .LVU188
 614 001e 234B     		ldr	r3, .L52
 615 0020 0422     		movs	r2, #4
 616 0022 1A70     		strb	r2, [r3]
 617              	.L43:
 226:display/menu.c **** 		}		
 618              		.loc 1 226 4 is_stmt 1 view .LVU189
 619 0024 214B     		ldr	r3, .L52
 620 0026 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 621 0028 FFF7FEFF 		bl	menu_select_preset_screen
 622              	.LVL47:
 623              	.L41:
 229:display/menu.c **** 		{
 624              		.loc 1 229 3 view .LVU190
 229:display/menu.c **** 		{
 625              		.loc 1 229 19 is_stmt 0 view .LVU191
 626 002c FFF7FEFF 		bl	scan_keys
ARM GAS  /tmp/ccAdRtMf.s 			page 18


 627              	.LVL48:
 229:display/menu.c **** 		{
 628              		.loc 1 229 17 view .LVU192
 629 0030 ADF80600 		strh	r0, [sp, #6]	@ movhi
 229:display/menu.c **** 		{
 630              		.loc 1 229 6 view .LVU193
 631 0034 A0B9     		cbnz	r0, .L51
 632              	.L44:
 213:display/menu.c **** 	{		
 633              		.loc 1 213 2 is_stmt 1 view .LVU194
 215:display/menu.c **** 		{
 634              		.loc 1 215 3 view .LVU195
 215:display/menu.c **** 		{
 635              		.loc 1 215 7 is_stmt 0 view .LVU196
 636 0036 2046     		mov	r0, r4
 637 0038 FFF7FEFF 		bl	read_encoder
 638              	.LVL49:
 215:display/menu.c **** 		{
 639              		.loc 1 215 6 view .LVU197
 640 003c 0128     		cmp	r0, #1
 641 003e F5D1     		bne	.L41
 217:display/menu.c **** 			HandleEncData->delta = 0;	
 642              		.loc 1 217 4 is_stmt 1 view .LVU198
 217:display/menu.c **** 			HandleEncData->delta = 0;	
 643              		.loc 1 217 31 is_stmt 0 view .LVU199
 644 0040 2179     		ldrb	r1, [r4, #4]	@ zero_extendqisi2
 217:display/menu.c **** 			HandleEncData->delta = 0;	
 645              		.loc 1 217 15 view .LVU200
 646 0042 1A4A     		ldr	r2, .L52
 647 0044 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 648 0046 0B44     		add	r3, r3, r1
 649 0048 DBB2     		uxtb	r3, r3
 650 004a 1370     		strb	r3, [r2]
 218:display/menu.c **** 			if (drive_mode > PRESET4)
 651              		.loc 1 218 4 is_stmt 1 view .LVU201
 218:display/menu.c **** 			if (drive_mode > PRESET4)
 652              		.loc 1 218 25 is_stmt 0 view .LVU202
 653 004c 0023     		movs	r3, #0
 654 004e 2371     		strb	r3, [r4, #4]
 219:display/menu.c **** 			{	drive_mode = PRESET1;	}
 655              		.loc 1 219 4 is_stmt 1 view .LVU203
 219:display/menu.c **** 			{	drive_mode = PRESET1;	}
 656              		.loc 1 219 19 is_stmt 0 view .LVU204
 657 0050 1378     		ldrb	r3, [r2]	@ zero_extendqisi2
 658 0052 DBB2     		uxtb	r3, r3
 219:display/menu.c **** 			{	drive_mode = PRESET1;	}
 659              		.loc 1 219 7 view .LVU205
 660 0054 042B     		cmp	r3, #4
 661 0056 DFD9     		bls	.L42
 220:display/menu.c **** 			else
 662              		.loc 1 220 6 is_stmt 1 view .LVU206
 220:display/menu.c **** 			else
 663              		.loc 1 220 17 is_stmt 0 view .LVU207
 664 0058 1346     		mov	r3, r2
 665 005a 0122     		movs	r2, #1
 666 005c 1A70     		strb	r2, [r3]
 667 005e E1E7     		b	.L43
ARM GAS  /tmp/ccAdRtMf.s 			page 19


 668              	.L51:
 231:display/menu.c **** 			{	
 669              		.loc 1 231 4 is_stmt 1 view .LVU208
 670 0060 BDF80630 		ldrh	r3, [sp, #6]
 671 0064 9BB2     		uxth	r3, r3
 672 0066 052B     		cmp	r3, #5
 673 0068 06D0     		beq	.L45
 674 006a 062B     		cmp	r3, #6
 675 006c 0FD0     		beq	.L46
 676              	.L47:
 240:display/menu.c **** 			}
 677              		.loc 1 240 6 view .LVU209
 242:display/menu.c **** 		}
 678              		.loc 1 242 4 view .LVU210
 679 006e 0F4B     		ldr	r3, .L52
 680 0070 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
 681 0072 FFF7FEFF 		bl	menu_select_preset_screen
 682              	.LVL50:
 683 0076 DEE7     		b	.L44
 684              	.L45:
 234:display/menu.c **** 					break;
 685              		.loc 1 234 6 view .LVU211
 234:display/menu.c **** 					break;
 686              		.loc 1 234 63 is_stmt 0 view .LVU212
 687 0078 0C4B     		ldr	r3, .L52
 688 007a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 689 007c 03F18043 		add	r3, r3, #1073741824
 690 0080 013B     		subs	r3, r3, #1
 234:display/menu.c **** 					break;
 691              		.loc 1 234 6 view .LVU213
 692 0082 55F82310 		ldr	r1, [r5, r3, lsl #2]
 693 0086 2046     		mov	r0, r4
 694 0088 FFF7FEFF 		bl	setup_menu
 695              	.LVL51:
 235:display/menu.c **** 				
 696              		.loc 1 235 6 is_stmt 1 view .LVU214
 697 008c EFE7     		b	.L47
 698              	.L46:
 238:display/menu.c **** 					return drive_mode; //–≤—ã—Ö–æ–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
 699              		.loc 1 238 6 view .LVU215
 700 008e 074C     		ldr	r4, .L52
 701              	.LVL52:
 238:display/menu.c **** 					return drive_mode; //–≤—ã—Ö–æ–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
 702              		.loc 1 238 6 is_stmt 0 view .LVU216
 703 0090 2078     		ldrb	r0, [r4]	@ zero_extendqisi2
 238:display/menu.c **** 					return drive_mode; //–≤—ã—Ö–æ–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
 704              		.loc 1 238 52 view .LVU217
 705 0092 2378     		ldrb	r3, [r4]	@ zero_extendqisi2
 706 0094 03F18043 		add	r3, r3, #1073741824
 707 0098 013B     		subs	r3, r3, #1
 238:display/menu.c **** 					return drive_mode; //–≤—ã—Ö–æ–¥ –≤ –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
 708              		.loc 1 238 6 view .LVU218
 709 009a 0022     		movs	r2, #0
 710 009c 55F82310 		ldr	r1, [r5, r3, lsl #2]
 711 00a0 FFF7FEFF 		bl	turn_drive_menu
 712              	.LVL53:
 239:display/menu.c **** 					break;
ARM GAS  /tmp/ccAdRtMf.s 			page 20


 713              		.loc 1 239 6 is_stmt 1 view .LVU219
 239:display/menu.c **** 					break;
 714              		.loc 1 239 13 is_stmt 0 view .LVU220
 715 00a4 2078     		ldrb	r0, [r4]	@ zero_extendqisi2
 716 00a6 C0B2     		uxtb	r0, r0
 245:display/menu.c **** 
 717              		.loc 1 245 1 view .LVU221
 718 00a8 03B0     		add	sp, sp, #12
 719              	.LCFI7:
 720              		.cfi_def_cfa_offset 12
 721              		@ sp needed
 722 00aa 30BD     		pop	{r4, r5, pc}
 723              	.LVL54:
 724              	.L53:
 245:display/menu.c **** 
 725              		.loc 1 245 1 view .LVU222
 726              		.align	2
 727              	.L52:
 728 00ac 00000000 		.word	.LANCHOR1
 729              		.cfi_endproc
 730              	.LFE953:
 732              		.section	.text.main_loop,"ax",%progbits
 733              		.align	1
 734              		.global	main_loop
 735              		.syntax unified
 736              		.thumb
 737              		.thumb_func
 739              	main_loop:
 740              	.LVL55:
 741              	.LFB951:
  42:display/menu.c **** 	__IO uint16_t key_code = NO_KEY; //–∫–æ–¥ –∫–Ω–æ–ø–∫–∏
 742              		.loc 1 42 1 is_stmt 1 view -0
 743              		.cfi_startproc
 744              		@ args = 0, pretend = 0, frame = 8
 745              		@ frame_needed = 0, uses_anonymous_args = 0
  42:display/menu.c **** 	__IO uint16_t key_code = NO_KEY; //–∫–æ–¥ –∫–Ω–æ–ø–∫–∏
 746              		.loc 1 42 1 is_stmt 0 view .LVU224
 747 0000 30B5     		push	{r4, r5, lr}
 748              	.LCFI8:
 749              		.cfi_def_cfa_offset 12
 750              		.cfi_offset 4, -12
 751              		.cfi_offset 5, -8
 752              		.cfi_offset 14, -4
 753 0002 83B0     		sub	sp, sp, #12
 754              	.LCFI9:
 755              		.cfi_def_cfa_offset 24
 756 0004 0446     		mov	r4, r0
 757 0006 0D46     		mov	r5, r1
  43:display/menu.c **** 	if ((key_code = scan_keys()) != NO_KEY)
 758              		.loc 1 43 2 is_stmt 1 view .LVU225
  43:display/menu.c **** 	if ((key_code = scan_keys()) != NO_KEY)
 759              		.loc 1 43 16 is_stmt 0 view .LVU226
 760 0008 0023     		movs	r3, #0
 761 000a ADF80630 		strh	r3, [sp, #6]	@ movhi
  44:display/menu.c **** 	{
 762              		.loc 1 44 2 is_stmt 1 view .LVU227
  44:display/menu.c **** 	{
ARM GAS  /tmp/ccAdRtMf.s 			page 21


 763              		.loc 1 44 18 is_stmt 0 view .LVU228
 764 000e FFF7FEFF 		bl	scan_keys
 765              	.LVL56:
  44:display/menu.c **** 	{
 766              		.loc 1 44 16 view .LVU229
 767 0012 ADF80600 		strh	r0, [sp, #6]	@ movhi
  44:display/menu.c **** 	{
 768              		.loc 1 44 5 view .LVU230
 769 0016 C8B1     		cbz	r0, .L54
  46:display/menu.c **** 		{	
 770              		.loc 1 46 3 is_stmt 1 view .LVU231
 771 0018 BDF80630 		ldrh	r3, [sp, #6]
 772 001c 9BB2     		uxth	r3, r3
 773 001e 023B     		subs	r3, r3, #2
 774 0020 062B     		cmp	r3, #6
 775 0022 13D8     		bhi	.L54
 776 0024 DFE803F0 		tbb	[pc, r3]
 777              	.L57:
 778 0028 04       		.byte	(.L61-.L57)/2
 779 0029 2A       		.byte	(.L60-.L57)/2
 780 002a 2A       		.byte	(.L60-.L57)/2
 781 002b 14       		.byte	(.L59-.L57)/2
 782 002c 1B       		.byte	(.L58-.L57)/2
 783 002d 40       		.byte	(.L56-.L57)/2
 784 002e 40       		.byte	(.L56-.L57)/2
 785 002f 00       		.p2align 1
 786              	.L61:
  49:display/menu.c **** 				while (scan_button_PEDAL() != OFF) {}	//–æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ–¥–∞–ª–∏
 787              		.loc 1 49 5 view .LVU232
 788 0030 244B     		ldr	r3, .L66
 789 0032 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  49:display/menu.c **** 				while (scan_button_PEDAL() != OFF) {}	//–æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ–¥–∞–ª–∏
 790              		.loc 1 49 53 is_stmt 0 view .LVU233
 791 0034 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 792 0036 03F18043 		add	r3, r3, #1073741824
 793 003a 013B     		subs	r3, r3, #1
  49:display/menu.c **** 				while (scan_button_PEDAL() != OFF) {}	//–æ–∂–∏–¥–∞–Ω–∏–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏—è –ø–µ–¥–∞–ª–∏
 794              		.loc 1 49 5 view .LVU234
 795 003c 55F82310 		ldr	r1, [r5, r3, lsl #2]
 796 0040 FFF7FEFF 		bl	start_drives_turn
 797              	.LVL57:
  50:display/menu.c **** 				break;
 798              		.loc 1 50 5 is_stmt 1 view .LVU235
 799              	.L62:
  50:display/menu.c **** 				break;
 800              		.loc 1 50 41 discriminator 1 view .LVU236
  50:display/menu.c **** 				break;
 801              		.loc 1 50 11 discriminator 1 view .LVU237
  50:display/menu.c **** 				break;
 802              		.loc 1 50 12 is_stmt 0 discriminator 1 view .LVU238
 803 0044 FFF7FEFF 		bl	scan_button_PEDAL
 804              	.LVL58:
  50:display/menu.c **** 				break;
 805              		.loc 1 50 11 discriminator 1 view .LVU239
 806 0048 0028     		cmp	r0, #0
 807 004a FBD1     		bne	.L62
 808              	.L54:
ARM GAS  /tmp/ccAdRtMf.s 			page 22


  85:display/menu.c **** 
 809              		.loc 1 85 1 view .LVU240
 810 004c 03B0     		add	sp, sp, #12
 811              	.LCFI10:
 812              		.cfi_remember_state
 813              		.cfi_def_cfa_offset 12
 814              		@ sp needed
 815 004e 30BD     		pop	{r4, r5, pc}
 816              	.LVL59:
 817              	.L59:
 818              	.LCFI11:
 819              		.cfi_restore_state
  54:display/menu.c **** 				break;
 820              		.loc 1 54 5 is_stmt 1 view .LVU241
  54:display/menu.c **** 				break;
 821              		.loc 1 54 18 is_stmt 0 view .LVU242
 822 0050 2946     		mov	r1, r5
 823 0052 2046     		mov	r0, r4
 824 0054 FFF7FEFF 		bl	menu_select_preset
 825              	.LVL60:
  54:display/menu.c **** 				break;
 826              		.loc 1 54 16 view .LVU243
 827 0058 1A4B     		ldr	r3, .L66
 828 005a 1870     		strb	r0, [r3]
  55:display/menu.c **** 			
 829              		.loc 1 55 5 is_stmt 1 view .LVU244
 830 005c F6E7     		b	.L54
 831              	.L58:
  58:display/menu.c **** 				{	settings_preset_reset (drive_mode, *(HandleCoilData + (drive_mode-1))); }//—Å–±—Ä–æ—Å –≤—ã–ø–
 832              		.loc 1 58 5 view .LVU245
  58:display/menu.c **** 				{	settings_preset_reset (drive_mode, *(HandleCoilData + (drive_mode-1))); }//—Å–±—Ä–æ—Å –≤—ã–ø–
 833              		.loc 1 58 20 is_stmt 0 view .LVU246
 834 005e 194B     		ldr	r3, .L66
 835 0060 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  58:display/menu.c **** 				{	settings_preset_reset (drive_mode, *(HandleCoilData + (drive_mode-1))); }//—Å–±—Ä–æ—Å –≤—ã–ø–
 836              		.loc 1 58 8 view .LVU247
 837 0062 002B     		cmp	r3, #0
 838 0064 F2D0     		beq	.L54
  59:display/menu.c **** 				break;
 839              		.loc 1 59 7 is_stmt 1 view .LVU248
 840 0066 174B     		ldr	r3, .L66
 841 0068 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  59:display/menu.c **** 				break;
 842              		.loc 1 59 59 is_stmt 0 view .LVU249
 843 006a 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 844 006c 03F18043 		add	r3, r3, #1073741824
 845 0070 013B     		subs	r3, r3, #1
  59:display/menu.c **** 				break;
 846              		.loc 1 59 7 view .LVU250
 847 0072 55F82310 		ldr	r1, [r5, r3, lsl #2]
 848 0076 FFF7FEFF 		bl	settings_preset_reset
 849              	.LVL61:
 850 007a E7E7     		b	.L54
 851              	.L60:
  64:display/menu.c **** 				setup_null_position ();  //—É—Å—Ç–∞–Ω–æ–≤–∫–∞ —Å–¥–≤–∏–≥–∞—é—â–µ–≥–æ –¥–≤–∏–≥–µ–ª—è –≤ –Ω—É–ª–µ
 852              		.loc 1 64 5 is_stmt 1 view .LVU251
 853 007c FFF7FEFF 		bl	mode_setup_null_screen
ARM GAS  /tmp/ccAdRtMf.s 			page 23


 854              	.LVL62:
  65:display/menu.c **** 				if (drive_mode != NO_PRESET) //–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–æ–º–µ—Ä –≤—ã–ø–æ–ª–Ω—è–µ–º–æ–≥–
 855              		.loc 1 65 5 view .LVU252
 856 0080 FFF7FEFF 		bl	setup_null_position
 857              	.LVL63:
  66:display/menu.c **** 				{	turn_drive_menu (drive_mode, *(HandleCoilData + (drive_mode-1)), 0); }//–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–
 858              		.loc 1 66 5 view .LVU253
  66:display/menu.c **** 				{	turn_drive_menu (drive_mode, *(HandleCoilData + (drive_mode-1)), 0); }//–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–
 859              		.loc 1 66 20 is_stmt 0 view .LVU254
 860 0084 0F4B     		ldr	r3, .L66
 861 0086 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
  66:display/menu.c **** 				{	turn_drive_menu (drive_mode, *(HandleCoilData + (drive_mode-1)), 0); }//–æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–
 862              		.loc 1 66 8 view .LVU255
 863 0088 5BB1     		cbz	r3, .L63
  67:display/menu.c **** 				else
 864              		.loc 1 67 7 is_stmt 1 view .LVU256
 865 008a 0E4B     		ldr	r3, .L66
 866 008c 1878     		ldrb	r0, [r3]	@ zero_extendqisi2
  67:display/menu.c **** 				else
 867              		.loc 1 67 53 is_stmt 0 view .LVU257
 868 008e 1B78     		ldrb	r3, [r3]	@ zero_extendqisi2
 869 0090 03F18043 		add	r3, r3, #1073741824
 870 0094 013B     		subs	r3, r3, #1
  67:display/menu.c **** 				else
 871              		.loc 1 67 7 view .LVU258
 872 0096 0022     		movs	r2, #0
 873 0098 55F82310 		ldr	r1, [r5, r3, lsl #2]
 874 009c FFF7FEFF 		bl	turn_drive_menu
 875              	.LVL64:
 876 00a0 D4E7     		b	.L54
 877              	.L63:
  69:display/menu.c **** 				break;
 878              		.loc 1 69 7 is_stmt 1 view .LVU259
 879 00a2 FFF7FEFF 		bl	main_menu_select_preset_screen
 880              	.LVL65:
 881 00a6 D1E7     		b	.L54
 882              	.L56:
  74:display/menu.c **** 				while (select_direction() == ERROR) {} //–æ–∂–∏–¥–∞–Ω–∏—è –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –≤—ã–±–æ—
 883              		.loc 1 74 5 view .LVU260
 884 00a8 FFF7FEFF 		bl	mode_setup_manual_dir_screen
 885              	.LVL66:
  75:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
 886              		.loc 1 75 5 view .LVU261
 887              	.L64:
  75:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
 888              		.loc 1 75 42 discriminator 1 view .LVU262
  75:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
 889              		.loc 1 75 11 discriminator 1 view .LVU263
  75:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
 890              		.loc 1 75 12 is_stmt 0 discriminator 1 view .LVU264
 891 00ac FFF7FEFF 		bl	select_direction
 892              	.LVL67:
  75:display/menu.c **** 				mode_setup_manual_screen (); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω
 893              		.loc 1 75 11 discriminator 1 view .LVU265
 894 00b0 B0F1FF3F 		cmp	r0, #-1
 895 00b4 FAD0     		beq	.L64
  76:display/menu.c **** 				manual_control_drive1 ();	//—Ñ-—è —Ä—É—á–Ω–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –ø–æ–ª–æ–∂–µ–Ω–∏—è —Å–¥–≤–∏–≥
ARM GAS  /tmp/ccAdRtMf.s 			page 24


 896              		.loc 1 76 5 is_stmt 1 view .LVU266
 897 00b6 FFF7FEFF 		bl	mode_setup_manual_screen
 898              	.LVL68:
  77:display/menu.c **** 				main_menu_select_preset_screen(); //–≤—ã–≤–æ–¥ –∑–∞—Å—Ç–∞–≤–∫–∏ —Ä–µ–∂–∏–º–∞ –≤—ã–±–æ—Ä–∞ –ø—Ä–
 899              		.loc 1 77 5 view .LVU267
 900 00ba FFF7FEFF 		bl	manual_control_drive1
 901              	.LVL69:
  78:display/menu.c **** 				break;
 902              		.loc 1 78 5 view .LVU268
 903 00be FFF7FEFF 		bl	main_menu_select_preset_screen
 904              	.LVL70:
  79:display/menu.c **** 		
 905              		.loc 1 79 5 view .LVU269
  85:display/menu.c **** 
 906              		.loc 1 85 1 is_stmt 0 view .LVU270
 907 00c2 C3E7     		b	.L54
 908              	.L67:
 909              		.align	2
 910              	.L66:
 911 00c4 00000000 		.word	.LANCHOR1
 912              		.cfi_endproc
 913              	.LFE951:
 915              		.global	drive_mode
 916              		.global	count_delay
 917              		.section	.bss.count_delay,"aw",%nobits
 918              		.set	.LANCHOR0,. + 0
 921              	count_delay:
 922 0000 00       		.space	1
 923              		.section	.data.drive_mode,"aw"
 924              		.set	.LANCHOR1,. + 0
 927              	drive_mode:
 928 0000 01       		.byte	1
 929              		.text
 930              	.Letext0:
 931              		.file 2 "/home/arashamf/soft/ARM_toolchains/gcc-arm-none-eabi-10.3-2021.10/arm-none-eabi/include/m
 932              		.file 3 "/home/arashamf/soft/ARM_toolchains/gcc-arm-none-eabi-10.3-2021.10/arm-none-eabi/include/s
 933              		.file 4 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_ll_dma.h"
 934              		.file 5 "Drivers/STM32F1xx_HAL_Driver/Inc/stm32f1xx_ll_tim.h"
 935              		.file 6 "Core/Inc/typedef.h"
 936              		.file 7 "Core/Inc/drive.h"
 937              		.file 8 "display/ssd1306.h"
 938              		.file 9 "Core/Inc/button.h"
 939              		.file 10 "Core/Inc/encoder.h"
 940              		.file 11 "Core/Inc/tim.h"
 941              		.file 12 "Core/Inc/calc_value.h"
ARM GAS  /tmp/ccAdRtMf.s 			page 25


DEFINED SYMBOLS
                            *ABS*:0000000000000000 menu.c
     /tmp/ccAdRtMf.s:18     .text.init_loop:0000000000000000 $t
     /tmp/ccAdRtMf.s:24     .text.init_loop:0000000000000000 init_loop
     /tmp/ccAdRtMf.s:103    .text.init_loop:000000000000004c $d
     /tmp/ccAdRtMf.s:108    .text.setup_menu:0000000000000000 $t
     /tmp/ccAdRtMf.s:114    .text.setup_menu:0000000000000000 setup_menu
     /tmp/ccAdRtMf.s:522    .text.setup_menu:00000000000001e0 $d
     /tmp/ccAdRtMf.s:527    .text.turn_drive_menu:0000000000000000 $t
     /tmp/ccAdRtMf.s:533    .text.turn_drive_menu:0000000000000000 turn_drive_menu
     /tmp/ccAdRtMf.s:567    .text.menu_select_preset:0000000000000000 $t
     /tmp/ccAdRtMf.s:573    .text.menu_select_preset:0000000000000000 menu_select_preset
     /tmp/ccAdRtMf.s:728    .text.menu_select_preset:00000000000000ac $d
     /tmp/ccAdRtMf.s:733    .text.main_loop:0000000000000000 $t
     /tmp/ccAdRtMf.s:739    .text.main_loop:0000000000000000 main_loop
     /tmp/ccAdRtMf.s:778    .text.main_loop:0000000000000028 $d
     /tmp/ccAdRtMf.s:911    .text.main_loop:00000000000000c4 $d
     /tmp/ccAdRtMf.s:927    .data.drive_mode:0000000000000000 drive_mode
     /tmp/ccAdRtMf.s:921    .bss.count_delay:0000000000000000 count_delay
     /tmp/ccAdRtMf.s:922    .bss.count_delay:0000000000000000 $d
     /tmp/ccAdRtMf.s:785    .text.main_loop:000000000000002f $d
     /tmp/ccAdRtMf.s:785    .text.main_loop:0000000000000030 $t

UNDEFINED SYMBOLS
release_pedal_menu
start_scan_key_PEDAL
delay_us
init_status_flags_drives
Stop_Count_Timers
calc_rotation_speed
drive2_turn
drive1_turn
setup_speed_screen
read_encoder
scan_keys
setup_ratio_screen
SoftStop_Drives
HardStop_Drives
setup_coil_screen
status_drives
default_screen
menu_select_preset_screen
start_drives_turn
scan_button_PEDAL
settings_preset_reset
mode_setup_null_screen
setup_null_position
main_menu_select_preset_screen
mode_setup_manual_dir_screen
select_direction
mode_setup_manual_screen
manual_control_drive1
